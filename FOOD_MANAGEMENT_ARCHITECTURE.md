# Food Management System Architecture

## System Overview

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         Challenge Gym APP                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ADMIN DASHBOARD (App.tsx)                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Admin Main Menu                                            â”‚ â”‚
â”‚  â”‚ â”œâ”€ Users Management                                        â”‚ â”‚
â”‚  â”‚ â”œâ”€ Plans Management                                        â”‚ â”‚
â”‚  â”‚ â”œâ”€ Exercises Management                                    â”‚ â”‚
â”‚  â”‚ â”œâ”€ Workouts Management                                     â”‚ â”‚
â”‚  â”‚ â”œâ”€ Shop Management                                         â”‚ â”‚
â”‚  â”‚ â”œâ”€ Orders Management                                       â”‚ â”‚
â”‚  â”‚ â”œâ”€ Explore Content                                         â”‚ â”‚
â”‚  â”‚ â”œâ”€ ğŸ¥— Food Nutrition Data â—„â”€â”€ NEW                         â”‚ â”‚
â”‚  â”‚ â””â”€ ...                                                     â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              AdminIndianFoods Component (TSX)                    â”‚
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Upload Section   â”‚  â”‚ Search Section   â”‚  â”‚ Preview      â”‚  â”‚
â”‚  â”‚                  â”‚  â”‚                  â”‚  â”‚              â”‚  â”‚
â”‚  â”‚ â€¢ File Input     â”‚  â”‚ â€¢ Search Box     â”‚  â”‚ â€¢ Data Table â”‚  â”‚
â”‚  â”‚ â€¢ CSV/XLSX       â”‚  â”‚ â€¢ Results List   â”‚  â”‚ â€¢ Validation â”‚  â”‚
â”‚  â”‚ â€¢ Template DL    â”‚  â”‚ â€¢ Pagination     â”‚  â”‚ â€¢ Confirmationâ”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Foods Table Section                                      â”‚  â”‚
â”‚  â”‚                                                          â”‚  â”‚
â”‚  â”‚  Dish Name  â”‚ Calories â”‚ Protein â”‚ Carbs â”‚ Fat â”‚ Delete â”‚  â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚  â”‚
â”‚  â”‚  Dal        â”‚ 234      â”‚ 8       â”‚ 12    â”‚ 15  â”‚  ğŸ—‘ï¸   â”‚  â”‚
â”‚  â”‚  Biryani    â”‚ 289      â”‚ 12      â”‚ 38    â”‚ 8   â”‚  ğŸ—‘ï¸   â”‚  â”‚
â”‚  â”‚  ...        â”‚ ...      â”‚ ...     â”‚ ...   â”‚ ... â”‚  ...   â”‚  â”‚
â”‚  â”‚                                                          â”‚  â”‚
â”‚  â”‚  [â—„ Previous] [1 of 5] [Next â–º]                         â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚                           â”‚                    â”‚
            â–¼                           â–¼                    â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚  fileParser.ts   â”‚      â”‚  Supabase API    â”‚  â”‚  indianFood   â”‚
   â”‚                  â”‚      â”‚                  â”‚  â”‚  Service.ts   â”‚
   â”‚ â€¢ parseCSV()     â”‚      â”‚ â€¢ upsert()       â”‚  â”‚               â”‚
   â”‚ â€¢ parseXLSX()    â”‚      â”‚ â€¢ select()       â”‚  â”‚ â€¢ search()    â”‚
   â”‚ â€¢ validate()     â”‚      â”‚ â€¢ delete()       â”‚  â”‚ â€¢ getById()   â”‚
   â”‚ â€¢ download()     â”‚      â”‚ â€¢ auth()         â”‚  â”‚ â€¢ getByRange()â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚                           â”‚                    â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚   Supabase Database         â”‚
              â”‚   (PostgreSQL)              â”‚
              â”‚                             â”‚
              â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
              â”‚  â”‚ indian_foods Table   â”‚  â”‚
              â”‚  â”‚                      â”‚  â”‚
              â”‚  â”‚ id (PK)              â”‚  â”‚
              â”‚  â”‚ dish_name (UNIQUE)   â”‚  â”‚
              â”‚  â”‚ calories_kcal        â”‚  â”‚
              â”‚  â”‚ carbohydrates_g      â”‚  â”‚
              â”‚  â”‚ protein_g            â”‚  â”‚
              â”‚  â”‚ fats_g               â”‚  â”‚
              â”‚  â”‚ free_sugar_g         â”‚  â”‚
              â”‚  â”‚ fibre_g              â”‚  â”‚
              â”‚  â”‚ sodium_mg            â”‚  â”‚
              â”‚  â”‚ calcium_mg           â”‚  â”‚
              â”‚  â”‚ iron_mg              â”‚  â”‚
              â”‚  â”‚ vitamin_c_mg         â”‚  â”‚
              â”‚  â”‚ folate_mcg           â”‚  â”‚
              â”‚  â”‚ created_at           â”‚  â”‚
              â”‚  â”‚ updated_at           â”‚  â”‚
              â”‚  â”‚                      â”‚  â”‚
              â”‚  â”‚ Indexes:             â”‚  â”‚
              â”‚  â”‚ â€¢ dish_name (fast    â”‚  â”‚
              â”‚  â”‚   searches)          â”‚  â”‚
              â”‚  â”‚ â€¢ calories_kcal      â”‚  â”‚
              â”‚  â”‚ â€¢ protein_g          â”‚  â”‚
              â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
              â”‚                             â”‚
              â”‚ RLS Policies:              â”‚
              â”‚ â€¢ PUBLIC: SELECT           â”‚
              â”‚ â€¢ ADMIN: INSERT/UPDATE     â”‚
              â”‚ â€¢ ADMIN: DELETE            â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Data Flow Diagram

### Upload Flow
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  User Selects   â”‚
â”‚   File (CSV)    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ File Input Event â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  parseFile(file)           â”‚
â”‚  - Detect Format           â”‚
â”‚  - Read Content            â”‚
â”‚  - Parse Rows              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  validateFoodRecords()      â”‚
â”‚  - Check Required Fields    â”‚
â”‚  - Validate Data Types      â”‚
â”‚  - Compile Errors           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
    â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”
    â”‚          â”‚
    â–¼          â–¼
  VALID     INVALID
    â”‚          â”‚
    â”‚          â””â”€â–º Show Error Message
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Show Preview (First 10)  â”‚
â”‚ User Confirms Upload     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Batch Upload (50 items)  â”‚
â”‚ - Split into batches     â”‚
â”‚ - Upsert to Supabase     â”‚
â”‚ - Handle duplicates      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Success Message          â”‚
â”‚ Refresh Foods List       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Search Flow
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ User Types Name  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ onChange Handler              â”‚
â”‚ - Update searchTerm state     â”‚
â”‚ - Reset to page 1             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ useEffect Triggers            â”‚
â”‚ - Calls fetchFoods()          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Supabase Query                â”‚
â”‚ - WHERE dish_name ILIKE       â”‚
â”‚ - LIMIT 20                    â”‚
â”‚ - ORDER BY dish_name          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Update Foods State            â”‚
â”‚ Display Results               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Delete Flow
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ User Clicks ğŸ—‘ï¸   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Show Confirm Buttons â”‚
â”‚ - Confirm / Cancel   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
    â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”
    â”‚          â”‚
    â–¼          â–¼
CONFIRM     CANCEL
    â”‚          â”‚
    â”‚          â””â”€â–º Close Dialog
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ DELETE from Supabase â”‚
â”‚ WHERE id = ?         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Show Success Message â”‚
â”‚ Refresh List         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Component Tree

```
App.tsx
â”œâ”€â”€ route === 'ADMIN_INDIAN_FOODS'
â”‚   â””â”€â”€ AdminIndianFoods
â”‚       â”œâ”€â”€ Header
â”‚       â”‚   â”œâ”€â”€ Back Button
â”‚       â”‚   â”œâ”€â”€ Title
â”‚       â”‚   â””â”€â”€ Total Count
â”‚       â”œâ”€â”€ Status Messages
â”‚       â”‚   â”œâ”€â”€ Error Alert
â”‚       â”‚   â””â”€â”€ Success Alert
â”‚       â”œâ”€â”€ Upload Section
â”‚       â”‚   â”œâ”€â”€ File Input
â”‚       â”‚   â””â”€â”€ Instructions
â”‚       â”œâ”€â”€ Preview Section (conditional)
â”‚       â”‚   â”œâ”€â”€ Table (first 10)
â”‚       â”‚   â”œâ”€â”€ Item Count
â”‚       â”‚   â””â”€â”€ Upload/Cancel Buttons
â”‚       â”œâ”€â”€ Search Section
â”‚       â”‚   â”œâ”€â”€ Search Input
â”‚       â”‚   â””â”€â”€ Clear All Button
â”‚       â””â”€â”€ Foods Table
â”‚           â”œâ”€â”€ Table Header
â”‚           â”œâ”€â”€ Table Rows
â”‚           â”‚   â”œâ”€â”€ Dish Name
â”‚           â”‚   â”œâ”€â”€ Nutrition Values
â”‚           â”‚   â””â”€â”€ Delete Button
â”‚           â””â”€â”€ Pagination
â”‚               â”œâ”€â”€ Info Text
â”‚               â””â”€â”€ Prev/Next Buttons
```

## File Parsing Logic

### CSV Parsing
```
CSV File (.csv)
    â”‚
    â–¼
Read as Text
    â”‚
    â–¼
Split by Newline (get rows)
    â”‚
    â–¼
Split First Row by Comma (headers)
    â”‚
    â”œâ”€â–º Find column indices:
    â”‚   â”œâ”€ Dish Name
    â”‚   â”œâ”€ Calories
    â”‚   â”œâ”€ Protein
    â”‚   â”œâ”€ Carbs
    â”‚   â””â”€ ...more columns
    â”‚
    â–¼
Iterate through rows 2-N
    â”‚
    â”œâ”€â–º Split by comma (get values)
    â”‚
    â”œâ”€â–º Map to schema:
    â”‚   â”œâ”€ values[dishNameIdx] â†’ dish_name
    â”‚   â”œâ”€ parseFloat(values[caloriesIdx]) â†’ calories_kcal
    â”‚   â””â”€ ...more mappings
    â”‚
    â”œâ”€â–º Skip empty rows
    â”‚
    â–¼
Return Array<ParsedFoodRecord>
```

### XLSX Parsing
```
XLSX File (.xlsx)
    â”‚
    â–¼
Read as ArrayBuffer
    â”‚
    â–¼
Parse with XLSX library
    â”‚
    â–¼
Get first worksheet
    â”‚
    â–¼
Convert to JSON
    â”‚ (XLSX lib auto-detects headers)
    â”‚
    â–¼
Map JSON rows to schema
    â”‚
    â”œâ”€â–º For each row:
    â”‚   â”œâ”€ Find Dish Name column
    â”‚   â”œâ”€ Find Calories column
    â”‚   â”œâ”€ Find optional columns
    â”‚   â””â”€ Create ParsedFoodRecord
    â”‚
    â–¼
Return Array<ParsedFoodRecord>
```

## State Management

```
AdminIndianFoods Component State:

â”Œâ”€ foods: IndianFood[]
â”‚  â””â”€ Current page foods
â”‚
â”œâ”€ loading: boolean
â”‚  â””â”€ Fetching foods
â”‚
â”œâ”€ uploading: boolean
â”‚  â””â”€ Uploading parsed records
â”‚
â”œâ”€ error: string
â”‚  â””â”€ Error messages
â”‚
â”œâ”€ success: string
â”‚  â””â”€ Success messages
â”‚
â”œâ”€ searchTerm: string
â”‚  â””â”€ Current search filter
â”‚
â”œâ”€ currentPage: number
â”‚  â””â”€ Pagination state
â”‚
â”œâ”€ totalItems: number
â”‚  â””â”€ Total food count
â”‚
â”œâ”€ parsedRecords: ParsedFoodRecord[]
â”‚  â””â”€ Records waiting to upload
â”‚
â”œâ”€ showPreview: boolean
â”‚  â””â”€ Show preview table
â”‚
â””â”€ deleteConfirm: number | null
   â””â”€ Item ID being confirmed for delete
```

## API Integration

```
Frontend (AdminIndianFoods)
    â”‚
    â”œâ”€â”€â–º supabase.from('indian_foods').select()
    â”‚    â””â”€â–º GET /rest/v1/indian_foods
    â”‚
    â”œâ”€â”€â–º supabase.from('indian_foods').upsert()
    â”‚    â””â”€â–º POST/PUT /rest/v1/indian_foods
    â”‚
    â”œâ”€â”€â–º supabase.from('indian_foods').delete()
    â”‚    â””â”€â–º DELETE /rest/v1/indian_foods
    â”‚
    â””â”€â”€â–º supabase.from('indian_foods').range()
         â””â”€â–º Pagination parameters

    â”‚
    â–¼
Supabase API Server
    â”‚
    â”œâ”€â–º JWT Verification
    â”‚
    â”œâ”€â–º RLS Policy Check
    â”‚
    â”œâ”€â–º Query Execution
    â”‚
    â””â”€â–º Response Format

    â”‚
    â–¼
PostgreSQL Database
    â”‚
    â”œâ”€â–º Execute SQL
    â”‚
    â”œâ”€â–º Apply Constraints
    â”‚
    â”œâ”€â–º Return Results
    â”‚
    â””â”€â–º Transaction Handling
```

## Security Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     User Authentication             â”‚
â”‚     (Supabase Auth)                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  JWT Token Validation               â”‚
â”‚  (Every API request)                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Role Check                         â”‚
â”‚  - Admin: full access               â”‚
â”‚  - User: read-only                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  RLS Policy Enforcement             â”‚
â”‚                                     â”‚
â”‚  SELECT: public (anyone)            â”‚
â”‚  INSERT: admin only                 â”‚
â”‚  UPDATE: admin only                 â”‚
â”‚  DELETE: admin only                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Database Constraint Checks         â”‚
â”‚  - UNIQUE dish_name                 â”‚
â”‚  - NOT NULL on required cols        â”‚
â”‚  - NUMERIC validation               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Performance Optimization

```
Upload Optimization:
    File â†’ Parse â†’ Validate â†’ Batch(50) â†’ Upload
                        â†“
                   Return Errors
                   (don't stop)

Query Optimization:
    SELECT * FROM foods
    WHERE dish_name ILIKE ? â”€â”€â–º INDEX
    LIMIT 20 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º OFFSET
    ORDER BY dish_name â”€â”€â”€â”€â”€â”€â”€â”€â–º INDEX

Database Indexes:
    â”Œâ”€ idx_indian_foods_dish_name
    â”‚  â””â”€ Fast ILIKE searches
    â”‚
    â”œâ”€ idx_indian_foods_calories
    â”‚  â””â”€ Range queries
    â”‚
    â””â”€ idx_indian_foods_protein
       â””â”€ Filter by protein
```

## Deployment Checklist

```
Code:
  âœ… AdminIndianFoods.tsx created
  âœ… fileParser.ts created
  âœ… Types updated
  âœ… App.tsx routes added
  âœ… AdminDashboard navigation added

Database:
  âœ… indian_foods table created
  âœ… Indexes created
  âœ… RLS policies enabled
  âœ… Constraints configured

Testing:
  â¬œ Upload small CSV
  â¬œ Upload XLSX file
  â¬œ Test search functionality
  â¬œ Test pagination
  â¬œ Test delete operations
  â¬œ Test error handling

Documentation:
  âœ… FOOD_MANAGEMENT_GUIDE.md
  âœ… FOOD_MANAGEMENT_QUICK_REFERENCE.md
  âœ… FOOD_MANAGEMENT_IMPLEMENTATION.md
  âœ… Architecture diagram (this file)

Deployment:
  â¬œ Build project (npm run build)
  â¬œ Test in production
  â¬œ Monitor performance
  â¬œ Gather user feedback
```

---

**Architecture Version**: 1.0  
**Last Updated**: January 26, 2026  
**System**: Challenge Gym Elite Fitness Coach - Food Management
